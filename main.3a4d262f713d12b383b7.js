(()=>{"use strict";var e={953:(e,t,s)=>{s.r(t)},309:(e,t,s)=>{s.r(t)},95:(e,t,s)=>{s.r(t)},523:(e,t,s)=>{s.r(t)},220:(e,t,s)=>{s.r(t)},76:(e,t,s)=>{s.r(t)},945:(e,t,s)=>{s.r(t)},310:(e,t,s)=>{s.r(t)},375:(e,t,s)=>{s.r(t)},720:(e,t,s)=>{s.r(t)},853:(e,t,s)=>{s.r(t)},528:(e,t,s)=>{s.r(t)},553:(e,t,s)=>{s.r(t)},616:(e,t,s)=>{s.r(t)},968:(e,t,s)=>{s.r(t)},887:(e,t,s)=>{s.r(t)},752:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.App=void 0;const n=s(977),i=s(366),a=s(186),o=s(644),r=s(769),l=s(368),c=s(471);t.App=class{constructor(e){this.rootElement=e,this.header=new n.Header,this.aboutGame=new i.AboutGame,this.bestScore=new a.BestScore,this.settings=new o.Settings,this.game=new r.Game,this.form=new l.Form,this.database=new c.Database,window.location.hash="#/",this.render(window.location.hash)}render(e){switch(this.rootElement.before(this.header.element),window.onhashchange=()=>this.render(window.location.hash),e){case"#/":this.rootElement.innerHTML="",this.rootElement.appendChild(this.aboutGame.element),document.querySelectorAll(".nav__item").forEach((e=>{e.classList.remove("active")})),document.querySelectorAll(".nav__item")[0].classList.add("active");break;case"#/game/":this.rootElement.innerHTML="",this.settings.isAnimal?this.game.newGame("Animals",this.settings.difficultyField):this.game.newGame("Cars",this.settings.difficultyField);break;case"#/best-score/":this.rootElement.innerHTML="",this.rootElement.appendChild(this.bestScore.element),this.bestScore.initRecords(),document.querySelectorAll(".nav__item").forEach((e=>{e.classList.remove("active")})),document.querySelectorAll(".nav__item")[1].classList.add("active");break;case"#/settings/":this.rootElement.innerHTML="",this.rootElement.appendChild(this.settings.element),this.settings.chooseCardType(),this.settings.chooseDifficulty(),document.querySelectorAll(".nav__item").forEach((e=>{e.classList.remove("active")})),document.querySelectorAll(".nav__item")[2].classList.add("active");break;default:throw new Error("No route")}}}},408:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AboutGameField=void 0;const n=s(583);s(953);class i extends n.BaseComponent{constructor(){super("div",["about-game__field"]),this.element.innerHTML='\n    <div class="about-game__blocks">\n\n      <div class="blocks__item">\n        <div class="item__number">1</div>\n        <p class="item__title">\n          Configure your game settings.\n        </p>\n      </div>\n\n      <div class="blocks__item">\n        <div class="item__number">2</div>\n        <p class="item__title">\n          Start you new game! Remember card\n          positions and match it before times up.\n          You have to wait 10 seconds before the cards will flip.\n        </p>\n      </div>\n\n      <div class="blocks__item">\n        <div class="item__number">3</div>\n        <p class="item__title">\n          If you want save your results register new player.<br>\n        </p>\n      </div>\n\n    </div>\n\n    <div class="about-game__images">\n      <div class="images__img"></div>\n      <div class="images__img"></div>\n      <div class="images__img"></div>\n    </div>\n    '}}t.AboutGameField=i},366:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AboutGame=void 0;const n=s(583),i=s(408);s(309);class a extends n.BaseComponent{constructor(){super("div",["about-game"]),this.aboutGameField=new i.AboutGameField,this.element.innerHTML='\n      <h3 class="about-game__title">\n        How to play?\n      </h3>\n    ',this.element.appendChild(this.aboutGameField.element)}}t.AboutGame=a},583:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseComponent=void 0,t.BaseComponent=class{constructor(e="div",t=[]){this.element=document.createElement(e),this.element.classList.add(...t)}}},186:function(e,t,s){var n=this&&this.__awaiter||function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function r(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BestScore=void 0;const i=s(583),a=s(41),o=s(471);s(95);class r extends i.BaseComponent{constructor(){super("div",["best-score"]),this.players=[],this.playersData=[],this.element.innerHTML='\n      <h2 class="best-score__title">Best players</h2>\n    ',this.db=new o.Database}initRecords(){this.db.init("frostwOw13"),setTimeout((()=>n(this,void 0,void 0,(function*(){this.playersData=yield this.db.readAll("frostwOw13"),setTimeout((()=>{this.playersData.forEach((e=>{const{score:t,firstName:s,secondName:n,email:i}=e;0!==this.players.length?(this.checkUniq(),this.players.push(new a.Player(`${s} ${n}`,i,t))):this.players.push(new a.Player(`${s} ${n}`,i,t))})),this.players.sort(((e,t)=>e.score>t.score?-1:e.score<t.score?1:0)),this.element.children.length<=10&&this.players.forEach((e=>{this.element.appendChild(e.element)}))}),100)}))),100)}checkUniq(){this.players=this.players.filter(((e,t,s)=>!s.slice(0,t).find((({score:t,fullName:s,email:n})=>t===e.score&&s===e.fullName&&n===e.email))))}}t.BestScore=r},41:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Player=void 0;const n=s(583);s(523);class i extends n.BaseComponent{constructor(e,t,s){super("div",["best-score__player"]),this.fullName=e,this.email=t,this.score=s,this.element.innerHTML=`\n      <div class="player__picture"></div>\n      <div class="player__item">\n        <p class="item__name">${this.fullName}</p>\n        <p class="item__email">${this.email}</p>\n      </div>\n      <p class="player__score">Score: <span class="player__score-number">${this.score}</span></p>\n    `}}t.Player=i},951:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CardSelf=void 0;const n=s(583);s(220);class i extends n.BaseComponent{constructor(e){super("div",["card"]),this.image=e,this.element.innerHTML=`\n      <div class="card_front" style="background-image: url('./images/${e}')"></div>\n      <div class="card_back"></div>\n    `}}t.CardSelf=i},343:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Card=void 0,s(76);const n=s(583),i=s(951),a=s(628);class o extends n.BaseComponent{constructor(e){super("div",["field-container__card"]),this.image=e,this.cardSelf=new i.CardSelf(e),this.isFlipped=!1,this.element.appendChild(this.cardSelf.element)}flipToBack(){return this.isFlipped=!0,this.flip(!0)}flipToFront(){return this.isFlipped=!1,this.flip()}flip(e=!1){return new Promise((t=>{this.element.classList.toggle(a.FLIP_CLASS,e),this.element.addEventListener("transitionend",(()=>t()),{once:!0})}))}}t.Card=o},368:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Form=void 0;const n=s(471),i=s(583),a=s(186);s(945);class o extends i.BaseComponent{constructor(){super("div",["form"]),this.isValidationSuccess=!1,this.playerData=[],this.element.innerHTML='\n      <div class="form__container">\n        <div class="form__body">\n          <div class="form__header">\n            <h3 class="header__title">Register new player</h3>\n          </div>\n\n          <div class="form-wrapper">\n            <form id="form" class="form">\n\n              <div class="form-control">\n                <label for="firstName">First name</label>\n                <input type="text" placeholder="Jones" id="firstName" maxlength="30"/>\n                <div class="checkbox">\n                  <span class="checkbox__first-part"></span>\n                  <span class="checkbox__second-part"></span>\n                </div>\n                <small>Error message</small>\n              </div>\n\n              <div class="form-control">\n                <label for="secondName">Second name</label>\n                <input type="text" placeholder="Dermot" id="secondName" maxlength="30"/>\n                <div class="checkbox">\n                  <span class="checkbox__first-part"></span>\n                  <span class="checkbox__second-part"></span>\n                </div>\n                <small>Error message</small>\n              </div>\n\n              <div class="form-control">\n                <label for="email">Email</label>\n                <input type="email" placeholder="example@gmail.com" id="email" maxlength="30"/>\n                <div class="checkbox">\n                  <span class="checkbox__first-part"></span>\n                  <span class="checkbox__second-part"></span>\n                </div>\n                <small>Error message</small>\n              </div>\n\n              <button id="cancel" class="btn">cancel</button>\n              <button id="add" class="btn">add user</button>\n\n            </form>\n\n            <div class="form__picture">\n              <div alt="load your picture" class="picture__img"></div>\n            </div>\n\n          </div>\n        </div>\n      </div>\n    ',this.db=new n.Database,this.bestScore=new a.BestScore}validate(e){const t=document.getElementById("add"),s=document.getElementById("firstName"),n=document.getElementById("secondName"),i=document.getElementById("email");this.playerData.push(e),t.addEventListener("click",(e=>{e.preventDefault(),this.checkInputs(s,n,i),4===this.playerData.length&&this.upToDB()}))}upToDB(){const e={score:this.playerData[0],firstName:this.playerData[1],secondName:this.playerData[2],email:this.playerData[3]};this.db.init("frostwOw13"),setTimeout((()=>{this.db.write("frostwOw13",e)}),100),window.location.hash="#/best-score/",this.bestScore.initRecords()}checkInputs(e,t,s){const n=document.getElementById("firstName").value.trim(),i=document.getElementById("secondName").value.trim(),a=document.getElementById("email").value.trim();""===n?o.setErrorFor(e,"First name cannot be blank"):o.isName(n)?o.setErrorFor(e,"First name cannot contain special characters"):o.isContainLetters(n)?(o.setSuccessFor(e),this.playerData.push(n)):o.setErrorFor(e,"First name cannot consist only of numbers"),""===i?o.setErrorFor(t,"Second name cannot be blank"):o.isName(i)?o.setErrorFor(t,"Second name cannot contain special characters"):o.isContainLetters(i)?(o.setSuccessFor(t),this.playerData.push(i)):o.setErrorFor(t,"First name cannot consist only of numbers"),""===a?o.setErrorFor(s,"Email cannot be blank"):o.isEmail(a)?(o.setSuccessFor(s),this.playerData.push(a)):o.setErrorFor(s,"Email cannot contain special characters")}static setErrorFor(e,t){const s=e.parentElement,n=null==s?void 0:s.querySelector("small");s&&(s.className="form-control error"),n&&(n.innerText=t)}static setSuccessFor(e){const t=e.parentElement;t&&(t.className="form-control success")}static isContainLetters(e){return/[^\d]/.test(e)}static isName(e){return/[~!@#$%*()_â€”+=|:;"'`<>,.?^]/.test(e)}static isEmail(e){return/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/.test(e)}}t.Form=o},245:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GameTimer=void 0;const n=s(583);s(310);class i extends n.BaseComponent{constructor(){super("div",["main__timer"]),this.element.innerHTML='\n      <p class="timer__count">00:00</p>\n    ',this.seconds=0,this.minutes=0}timerStart(){this.interval=setInterval((()=>{this.seconds>59?(this.minutes++,this.seconds=0):this.seconds++,this.element.innerHTML=`\n        <p class="timer__count">${this.minutes<10?`0${this.minutes}`:this.minutes}:\n          ${this.seconds<10?`0${this.seconds}`:this.seconds}</p>\n      `}),1e3)}timerStop(){this.minutes=0,this.seconds=0,clearInterval(this.interval),this.element.innerHTML='\n      <p class="timer__count">00:00</p>\n    '}}t.GameTimer=i},47:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderLogo=void 0;const n=s(583);s(375);class i extends n.BaseComponent{constructor(){super("div",["header__logo-container"]),this.element.innerHTML='\n      <h3 class="logo-container__logo">match</h3>\n      <button class="logo-container__btn">match</button>\n    '}}t.HeaderLogo=i},65:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderNav=void 0;const n=s(583);s(720);class i extends n.BaseComponent{constructor(){super("div",["header__nav"]),this.element.innerHTML='\n        <div class="nav__item">\n          <a href="#/" class="nav__link">\n            <i class="fas fa-question-circle fa-lg"></i>\n            <p class="nav__title">About game</p>\n          </a>\n        </div>\n\n        <div class="nav__item">\n          <a href="#/best-score/" class="nav__link">\n            <i class="fas fa-star fa-lg"></i>\n            <p class="nav__title">Best score</p>\n          </a>\n        </div>\n\n        <div class="nav__item">\n          <a href="#/settings/" class="nav__link">\n            <i class="fas fa-cog fa-lg"></i>\n            <p class="nav__title">Game setting</p>\n          </a>\n        </div>\n    '}}t.HeaderNav=i},642:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderReg=void 0;const n=s(583);s(853);class i extends n.BaseComponent{constructor(){super("div",["header__reg-container"]),this.element.innerHTML='\n      <a href="#/game/" class="reg__link">\n        <button class="header__btn">start game</button>\n      </a>\n    '}}t.HeaderReg=i},977:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Header=void 0;const n=s(583),i=s(47),a=s(65),o=s(642);s(528);class r extends n.BaseComponent{constructor(){super("header",["header"]),this.headerLogo=new i.HeaderLogo,this.headerNav=new a.HeaderNav,this.headerReg=new o.HeaderReg,this.element.appendChild(this.headerLogo.element),this.element.appendChild(this.headerNav.element),this.element.appendChild(this.headerReg.element)}}t.Header=r},775:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MainField=void 0;const n=s(583);s(553);const i=s(628);class a extends n.BaseComponent{constructor(){super("div",["main__field"]),this.cards=[]}clear(){this.cards=[],this.element.innerHTML=""}addCards(e){this.cards=e,this.cards.forEach((e=>this.element.appendChild(e.element))),setTimeout((()=>{this.cards.forEach((e=>e.flipToBack()))}),i.SHOW_TIME)}removeAddClass(e,t,s){e.classList.add("red"),t.classList.add("red"),this.interval=setInterval((()=>{e.classList.remove(s),t.classList.remove(s)}),1e3)}}t.MainField=a},381:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PopUp=void 0;const n=s(583),i=s(368);s(616);class a extends n.BaseComponent{constructor(){super("div",["pop-up"]),this.isReg=!1,this.form=new i.Form}winner(e,t,s){this.element.innerHTML=`\n      <div class="pop-up__body">\n        <div class="pop-up__content">\n          <div class="pop-up__text">\n          Congratulations! You successfully found all matches on ${60*e+t} seconds.\n          You have scored ${s} points. Would you like to save your results?\n          </div>\n          <div class="buttons">\n            <button id="yes" class="btn">Yes</button>\n            <button id="no" class="btn">No</button>\n          </div>\n        </div>\n      </div>\n    `,document.body.addEventListener("click",(e=>{const t=e.target;if("no"===t.id){window.location.hash="#/";const e=document.querySelector(".timer__count");e&&(e.innerHTML="00:00")}else"yes"===t.id&&(this.isReg=!0,this.element.classList.add("hidden"),this.element.before(this.form.element),this.form.validate(s))}))}}t.PopUp=a},960:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CardsType=void 0;const n=s(583);class i extends n.BaseComponent{constructor(){super("div",["settings__item"]),this.element.innerHTML='\n      <p class="item__title">Game cards</p>\n      <div class="settings-chooser">\n        <select id="cards-type" class="settings-chooser__select">\n          <option value="Animals">Animals</option>\n          <option value="Cars">Cars</option>\n        </select>\n      </div>\n    '}}t.CardsType=i},552:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Difficulty=void 0;const n=s(583);class i extends n.BaseComponent{constructor(){super("div",["settings__item"]),this.element.innerHTML='\n      <p class="item__title">Difficulty</p>\n      <div class="settings-chooser">\n        <select id="difficulty" class="settings-chooser__select">\n          <option value="1">4x3</option>\n          <option value="2">4x4</option>\n          <option value="3">4x5</option>\n        </select>\n      </div>\n    '}}t.Difficulty=i},644:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Settings=void 0;const n=s(583),i=s(960),a=s(552);s(968);class o extends n.BaseComponent{constructor(){super("div",["settings"]),this.cardsType=new i.CardsType,this.difficulty=new a.Difficulty,this.isAnimal=!0,this.isCar=!1,this.difficultyField="4x3",this.element.appendChild(this.cardsType.element),this.element.appendChild(this.difficulty.element)}chooseCardType(){const e=document.getElementById("cards-type");e.addEventListener("input",(()=>{"Animals"===e.value?(this.isCar=!1,this.isAnimal=!0):"Cars"===e.value&&(this.isAnimal=!1,this.isCar=!0)}))}chooseDifficulty(){const e=document.getElementById("difficulty");e.addEventListener("input",(()=>{"1"===e.value?this.difficultyField="4x3":"2"===e.value?this.difficultyField="4x4":"3"===e.value&&(this.difficultyField="4x5")}))}}t.Settings=o},471:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Database=void 0,t.Database=class{constructor(){this.db=null}init(e,t){return new Promise(((s,n)=>{const i=window.indexedDB.open(e,t);i.onupgradeneeded=()=>{const t=i.result;t.createObjectStore(e,{keyPath:"id",autoIncrement:!0}).createIndex("score","score"),this.db=t,s(this.db)},i.onsuccess=()=>{this.db=i.result,s(this.db)},i.onerror=()=>{n(this.db)}}))}write(e,t){const s=this.db.transaction(e,"readwrite").objectStore(e),n=s.add({});n.onsuccess=()=>{const e=Object.assign(Object.assign({},t),{id:n.result});return s.put(e)}}readAll(e){return new Promise(((t,s)=>{const n=this.db.transaction(e,"readonly"),i=n.objectStore(e).getAll();n.oncomplete=()=>{t(i.result)},n.onerror=()=>{s(i.error)}}))}}},769:function(e,t,s){var n=this&&this.__awaiter||function(e,t,s,n){return new(s||(s=Promise))((function(i,a){function o(e){try{l(n.next(e))}catch(e){a(e)}}function r(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;const i=s(343),a=s(245),o=s(775),r=s(381),l=s(680),c=s(628),d=s(368);class m{constructor(){this.isAnimation=!1,this.gameTimer=new a.GameTimer,this.mainField=new o.MainField,this.popUp=new r.PopUp,this.form=new d.Form,this.gameFirstStart=!1,this.score=0,this.falseCards=0}addField(e){this.mainField.clear();const t=e.concat(e).map((e=>new i.Card(e))).sort((()=>Math.random()-.5));this.mainField.addCards(t),t.forEach((e=>{e.element.addEventListener("click",(()=>this.cardHandler(e)))}))}cardHandler(e){return n(this,void 0,void 0,(function*(){if(!this.isAnimation&&e.isFlipped){if(this.isAnimation=!0,yield e.flipToFront(),!this.activeCard)return this.activeCard=e,void(this.isAnimation=!1);if(this.activeCard.image!==e.image)this.mainField.removeAddClass(this.activeCard.cardSelf.element,e.cardSelf.element,"red"),this.falseCards++,yield l.delay(c.FLIP_DELAY),yield Promise.all([this.activeCard.flipToBack(),e.flipToBack()]);else{this.activeCard.cardSelf.element.classList.add("green"),e.cardSelf.element.classList.add("green");let t=0;this.mainField.cards.forEach((e=>{e.cardSelf.element.classList.contains("green")&&(t++,t===this.mainField.cards.length&&(this.activeCard=void 0,this.isAnimation=!1,this.win()))})),t=0}this.activeCard=void 0,this.isAnimation=!1}}))}newGame(e,t){return n(this,void 0,void 0,(function*(){this.gameTimer.timerStop();const s=yield fetch("./images.json"),n=yield s.json(),i="Animals"===e?n[0]:n[1],a=i.images.slice().map((e=>`${i.category}/${e}`));this.continueGame(),"4x3"===t?(m.flipField(),this.addField(a.slice(4))):"4x4"===t?(m.flipField(),this.addField(a.slice(2))):(this.addField(a),m.flipField()),this.gameTimer.timerStart()}))}static flipField(){document.querySelectorAll(".field-container__card").forEach((e=>{null==e||e.classList.toggle("fieldFlip")}))}continueGame(){var e,t;null===(e=document.getElementById("main"))||void 0===e||e.appendChild(this.gameTimer.element),null===(t=document.getElementById("main"))||void 0===t||t.appendChild(this.mainField.element)}win(){var e,t;const s=Number(null===(e=document.querySelector(".timer__count"))||void 0===e?void 0:e.innerHTML.split(":")[0]),n=Number(null===(t=document.querySelector(".timer__count"))||void 0===t?void 0:t.innerHTML.split(":")[1]);this.gameTimer.timerStop(),this.score=100*(this.mainField.cards.length-this.falseCards)-(60*s+n),this.score<0&&(this.score=0),this.mainField.element.appendChild(this.popUp.element),this.popUp.element.classList.add("active"),this.popUp.winner(s,n,this.score),this.popUp.isReg&&(this.popUp.element.classList.add("hidden"),this.mainField.element.appendChild(this.form.element)),this.gameFirstStart=!1}}t.Game=m},628:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SHOW_TIME=t.FLIP_CLASS=t.FLIP_DELAY=void 0,t.FLIP_DELAY=1e3,t.FLIP_CLASS="flipped",t.SHOW_TIME=1e4},680:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise((t=>{setTimeout(t,e)}))}}},t={};function s(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,s),a.exports}s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{s(887);const e=s(752);window.onload=()=>{const t=document.getElementById("main");if(!t)throw Error("App root element not found");new e.App(t).render("#/")}})()})();